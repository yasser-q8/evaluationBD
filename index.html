<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Evaluation Form - بنت الديك مطاعم | Bent Al-Deek Restaurants</title>
    <!-- Company Logo Icon -->
    <link rel="icon" href="https://i.postimg.cc/ry4Bxx0L/Bent_Aldeek_Logo.jpg" type="image/jpeg">
    <!-- JavaScript Libraries for PDF Creation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #FFA500;
            --secondary-color: #FFD700;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --gold-color: #ffd700;
            --light-bg: #f8f9fa;
            --border-color: #dee2e6;
            --yellow-light: #fff9e6;
            --yellow-medium: #ffeb99;
            --yellow-dark: #cc8400;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding-bottom: 50px;
            font-size: 90%;
        }
        
        .container {
            max-width: 1300px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Page Header */
        .header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 0;
            text-align: center;
            border-bottom: 5px solid var(--gold-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
        }
        
        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid white;
            margin-left: 10px;
        }
        
        .header h1 {
            font-size: 26px;
            margin-bottom: 8px;
        }
        
        .header p {
            font-size: 15px;
            opacity: 0.9;
        }
        
        /* Restaurant Selection */
        .restaurant-selector {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
        }
        
        .restaurant-info {
            flex: 1;
            min-width: 300px;
        }
        
        .restaurant-search-container {
            position: relative;
            width: 100%;
        }
        
        #restaurant-search {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 15px;
            margin-top: 8px;
            background-color: white;
        }
        
        .restaurant-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 0 0 5px 5px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .restaurant-dropdown-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        
        .restaurant-dropdown-item:hover {
            background-color: #f5f5f5;
        }
        
        .restaurant-details {
            flex: 1;
            min-width: 300px;
            padding-right: 20px;
        }
        
        .restaurant-details p {
            margin: 8px 0;
            font-size: 16px;
            font-weight: bold;
        }
        
        .evaluator-input {
            flex: 1;
            min-width: 300px;
            margin-top: 15px;
        }
        
        .evaluator-input input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 15px;
            margin-top: 8px;
        }
        
        /* Central Circle Diagram */
        .diagram-section {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            text-align: center;
        }
        
        .diagram-title {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 20px;
            font-weight: bold;
        }
        
        .diagram-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            height: 450px;
            margin: 0 auto;
        }
        
        .center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 180px;
            height: 180px;
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.2);
            border: 6px solid white;
        }
        
        .center-text {
            color: white;
            font-weight: bold;
            font-size: 18px;
            text-align: center;
            padding: 15px;
        }
        
        .axis-box {
            position: absolute;
            width: 180px;
            height: 120px;
            background-color: white;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border: 3px solid;
            padding: 15px;
            z-index: 5;
            transition: all 0.3s ease;
        }
        
        .axis-box:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }
        
        .axis-box.top-left {
            top: 15%;
            right: 10%;
            border-color: #FFD700;
        }
        
        .axis-box.top-right {
            top: 15%;
            left: 10%;
            border-color: #FFA500;
        }
        
        .axis-box.bottom-left {
            bottom: 15%;
            right: 10%;
            border-color: #E6B800;
        }
        
        .axis-box.bottom-right {
            bottom: 15%;
            left: 10%;
            border-color: #FF8C00;
        }
        
        .axis-title {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .axis-score {
            font-size: 24px;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .axis-total {
            font-size: 14px;
            color: #666;
        }
        
        /* Animated Statistics Cards */
        .stats-container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 25px;
            position: relative;
        }
        
        .stat-card {
            flex: 1;
            min-width: 200px;
            margin: 8px;
            padding: 18px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
            text-align: center;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0px); }
        }
        
        .stat-card.yellow { background-color: var(--yellow-light); border-top: 5px solid var(--warning-color); }
        .stat-card.orange { background-color: #fff4e6; border-top: 5px solid #ff9800; }
        .stat-card.green { background-color: #e8f7ef; border-top: 5px solid var(--success-color); }
        .stat-card.gold { background-color: #fffce6; border-top: 5px solid var(--gold-color); }
        
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        /* Evaluation Form */
        .evaluation-form {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .section-title {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0 12px;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-number {
            background-color: white;
            color: var(--primary-color);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 16px;
        }
        
        .criteria-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 13px;
        }
        
        .criteria-table th {
            background-color: var(--light-bg);
            padding: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
            font-size: 13px;
        }
        
        .criteria-table td {
            padding: 10px;
            border: 1px solid var(--border-color);
            text-align: center;
            vertical-align: middle;
        }
        
        .criteria-number {
            text-align: center;
            width: 50px;
            font-weight: bold;
        }
        
        .criteria-name {
            width: 30%;
            text-align: right;
            font-size: 14px;
            font-weight: bold;
        }
        
        .max-score {
            text-align: center;
            width: 80px;
        }
        
        .achieved-score {
            text-align: center;
            width: 120px;
        }
        
        .notes {
            width: 20%;
        }
        
        .not-available {
            width: 100px;
            text-align: center;
        }
        
        .score-btn {
            width: 80px;
            height: 50px;
            padding: 0;
            border: 2px solid var(--secondary-color);
            border-radius: 8px;
            background-color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto;
        }
        
        .score-btn:hover {
            background-color: #f0f8ff;
            transform: scale(1.05);
        }
        
        .score-btn.active {
            background-color: var(--secondary-color);
            color: white;
        }
        
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 13px;
        }
        
        /* Evaluation Results */
        .results-summary {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .results-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-color);
            font-size: 22px !important;
            font-weight: bold;
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .results-table th {
            background-color: var(--secondary-color);
            color: white;
            padding: 14px;
            text-align: center;
            font-size: 15px;
        }
        
        .results-table td {
            padding: 12px;
            border: 1px solid var(--border-color);
            text-align: center;
        }
        
        .total-row {
            font-weight: bold;
            background-color: var(--light-bg);
            font-size: 16px;
        }
        
        .percentage-cell {
            font-weight: bold;
            border-radius: 4px;
            color: black !important;
        }
        
        .final-evaluation-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto;
            border: 3px solid #ddd;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 18px;
            color: white;
        }
        
        /* Control Buttons */
        .control-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #FFA500;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #e67e22;
        }

        /* Developer Signature */
        .signature-card {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(135deg, #FF6E00, #2196F3);
            color: white;
            padding: 10.5px 17.5px;
            border-radius: 8.5px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 1000;
            animation: float 6s ease-in-out infinite;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .signature-card:hover { 
            transform: scale(1.05); 
            box-shadow: 0 12px 35px rgba(0,0,0,0.4); 
        }

        @keyframes float { 
            0% { transform: translateY(0px); } 
            50% { transform: translateY(-15px); } 
            100% { transform: translateY(0px); } 
        }

        .signature-card::before {
            content: '';
            position: absolute;
            top: -2px; left: -2px; right: -2px; bottom: -2px;
            background: linear-gradient(135deg, #80EF80, #2196F3);
            border-radius: 14px;
            z-index: -1;
            animation: borderGlow 3s linear infinite;
            background-size: 400%;
        }

        @keyframes borderGlow { 
            0% { background-position: 0% 50%; } 
            50% { background-position: 100% 50%; } 
            100% { background-position: 0% 50%; } 
        }

        .signature-card .name { 
            font-size: 0.95rem; 
            font-weight: 700; 
            margin-bottom: 5px; 
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3); 
        }

        .signature-card .title { 
            font-size: 0.7rem; 
            opacity: 0.9; 
            font-weight: 500; 
        }

        @media (max-width: 768px) { 
            .signature-card { 
                position: relative; 
                bottom: auto; 
                left: auto; 
                margin: 20px auto 0; 
                width: fit-content; 
                animation: none; 
            } 
            .signature-card:hover { 
                transform: none; 
            } 
        }

        @media print {
            .signature-card {
                display: none;
            }
        }
        
        /* Print Design */
        @media print {
            body {
                font-size: 80%;
                transform: scale(0.9);
                transform-origin: top center;
            }
            
            .stats-container,
            .control-buttons,
            .diagram-section,
            .restaurant-selector .restaurant-details {
                display: none;
            }
            
            .evaluation-form,
            .results-summary {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            
            .restaurant-selector {
                border: 1px solid #ddd;
                box-shadow: none;
            }
            
            .header {
                box-shadow: none;
                border-bottom: 2px solid var(--gold-color);
            }
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .diagram-container {
                height: 400px;
            }
            
            .center-circle {
                width: 150px;
                height: 150px;
            }
            
            .axis-box {
                width: 160px;
                height: 110px;
            }
        }
        
        @media (max-width: 768px) {
            .diagram-container {
                height: 350px;
            }
            
            .center-circle {
                width: 130px;
                height: 130px;
            }
            
            .center-text {
                font-size: 16px;
            }
            
            .axis-box {
                width: 140px;
                height: 100px;
                padding: 10px;
            }
            
            .axis-title {
                font-size: 14px;
            }
            
            .axis-score {
                font-size: 20px;
            }
            
            .stats-container {
                flex-direction: column;
            }
            
            .criteria-table {
                font-size: 12px;
                display: block;
                overflow-x: auto;
            }
            
            .criteria-table th,
            .criteria-table td {
                padding: 6px;
            }
            
            .criteria-name {
                font-size: 13px;
            }
            
            .score-btn {
                width: 70px;
                height: 45px;
                font-size: 16px;
            }
            
            .control-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                margin-bottom: 10px;
            }
            
            .restaurant-selector {
                flex-direction: column;
            }
            
            .restaurant-details {
                padding-right: 0;
                margin-top: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .diagram-container {
                height: 300px;
            }
            
            .center-circle {
                width: 110px;
                height: 110px;
            }
            
            .center-text {
                font-size: 14px;
            }
            
            .axis-box {
                width: 120px;
                height: 85px;
            }
            
            .axis-title {
                font-size: 12px;
            }
            
            .axis-score {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Page Header -->
    <div class="header">
        <div class="container">
            <div class="logo-container">
                <img src="https://i.postimg.cc/ry4Bxx0L/Bent_Aldeek_Logo.jpg" alt="Bent Al-Deek Restaurants Logo | شعار مطاعم بنت الديك" class="logo">
            </div>
            <h1>Restaurant Evaluation Form | نموذج تقييم المطعم</h1>
            <p>Bent Al-Deek Restaurants | مطاعم بنت الديك | Comprehensive Evaluation System (1250 points max) | نظام التقييم الشامل (1250 درجة كحد أقصى)</p>
        </div>
    </div>

    <div class="container">
        <!-- Restaurant Selection -->
        <div class="restaurant-selector">
            <div class="restaurant-info">
                <label for="restaurant-search"><strong>Select Restaurant: | اختر المطعم:</strong></label>
                <div class="restaurant-search-container">
                    <input type="text" id="restaurant-search" placeholder="Search for restaurant... | ابحث عن المطعم..." autocomplete="off">
                    <div class="restaurant-dropdown" id="restaurant-dropdown"></div>
                </div>
                <input type="hidden" id="selected-restaurant" value="">
            </div>
            <div class="restaurant-details">
                <p><strong>Area Manager: | مدير المنطقة:</strong> <span id="area-manager">-</span></p>
                <p><strong>Operation Manager: | مدير التشغيل:</strong> <span id="operation-manager">-</span></p>
            </div>
            <div class="evaluator-input">
                <label for="evaluator-name"><strong>Evaluator: | القائم بعملية التقييم:</strong></label>
                <input type="text" id="evaluator-name" placeholder="Evaluator Name | اسم المقيم">
            </div>
        </div>

        <!-- Central Circle Diagram -->
        <div class="diagram-section" id="excellence-diagram">
            <h3 class="diagram-title">Excellence Core Elements | العناصر الأساسية للتميز</h3>
            <div class="diagram-container">
                <!-- Connecting Lines -->
                <div class="connecting-line" id="line1"></div>
                <div class="connecting-line" id="line2"></div>
                <div class="connecting-line" id="line3"></div>
                <div class="connecting-line" id="line4"></div>
                
                <!-- Center Circle -->
                <div class="center-circle">
                    <div class="center-text">
                        Goal: | الهدف:<br>Absolute Quality | الجودة المطلقة
                    </div>
                </div>
                
                <!-- Surrounding Boxes -->
                <div class="axis-box top-left" id="service-box">
                    <div class="axis-title">Customer Service | خدمة العملاء</div>
                    <div class="axis-score">0</div>
                    <div class="axis-total">of 200 | من 200</div>
                </div>
                
                <div class="axis-box top-right" id="cleanliness-box">
                    <div class="axis-title">Cleanliness | النظافة</div>
                    <div class="axis-score">0</div>
                    <div class="axis-total">of 300 | من 300</div>
                </div>
                
                <div class="axis-box bottom-left" id="equipment-box">
                    <div class="axis-title">Restaurant Equipment | تجهيزات المطعم</div>
                    <div class="axis-score">0</div>
                    <div class="axis-total">of 250 | من 250</div>
                </div>
                
                <div class="axis-box bottom-right" id="management-box">
                    <div class="axis-title">Restaurant Management | إدارة المطعم</div>
                    <div class="axis-score">0</div>
                    <div class="axis-total">of 250 | من 250</div>
                </div>
            </div>
        </div>

        <!-- Animated Statistics Cards -->
        <div class="stats-container">
            <div class="stat-card floating yellow">
                <div class="stat-value" id="total-score">0</div>
                <div class="stat-label">Total Achieved Points | إجمالي الدرجات المحققة</div>
            </div>
            <div class="stat-card floating orange">
                <div class="stat-value" id="total-percentage">0%</div>
                <div class="stat-label">Total Percentage | النسبة المئوية الإجمالية</div>
            </div>
            <div class="stat-card floating green">
                <div class="stat-value" id="quality-score">250</div>
                <div class="stat-label">Quality Points (Remaining) | درجة الجودة (متبقي)</div>
            </div>
            <div class="stat-card floating gold">
                <div class="stat-value" id="final-grade">-</div>
                <div class="stat-label">Final Evaluation | التقييم النهائي</div>
            </div>
        </div>

        <!-- Evaluation Form -->
        <div class="evaluation-form">
            <h2 style="text-align: center; margin-bottom: 15px; color: var(--primary-color); font-size: 20px;">Restaurant Evaluation Form (1250 points max) | نموذج تقييم المطعم (1250 درجة كحد أقصى)</h2>
            
            <!-- Axis 1: Customer Service -->
            <div class="section-title">
                <span>1. Customer Service | خدمة العملاء</span>
                <div class="section-number">200</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%">No. | الرقم</th>
                        <th width="30%">Main Axis | المحور الرئيسي</th>
                        <th width="8%">Max Score | الدرجة القصوى</th>
                        <th width="12%">Achieved Score | الدرجة المحققة</th>
                        <th width="10%">Not Available | غير متوفر</th>
                        <th width="35%">Notes | الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="service-criteria">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- Axis 2: Cleanliness -->
            <div class="section-title">
                <span>2. Cleanliness | النظافة</span>
                <div class="section-number">300</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%">No. | الرقم</th>
                        <th width="30%">Main Axis | المحور الرئيسي</th>
                        <th width="8%">Max Score | الدرجة القصوى</th>
                        <th width="12%">Achieved Score | الدرجة المحققة</th>
                        <th width="10%">Not Available | غير متوفر</th>
                        <th width="35%">Notes | الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="cleanliness-criteria">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- Axis 3: Equipment -->
            <div class="section-title">
                <span>3. Equipment | المعدات والتجهيزات</span>
                <div class="section-number">250</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%">No. | الرقم</th>
                        <th width="30%">Main Axis | المحور الرئيسي</th>
                        <th width="8%">Max Score | الدرجة القصوى</th>
                        <th width="12%">Achieved Score | الدرجة المحققة</th>
                        <th width="10%">Not Available | غير متوفر</th>
                        <th width="35%">Notes | الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="equipment-criteria">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- Axis 4: Management -->
            <div class="section-title">
                <span>4. Management | إدارة المطعم</span>
                <div class="section-number">250</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%">No. | الرقم</th>
                        <th width="30%">Main Axis | المحور الرئيسي</th>
                        <th width="8%">Max Score | الدرجة القصوى</th>
                        <th width="12%">Achieved Score | الدرجة المحققة</th>
                        <th width="10%">Not Available | غير متوفر</th>
                        <th width="35%">Notes | الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="management-criteria">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- Axis 5: Quality -->
            <div class="section-title">
                <span>5. Quality | الجودة</span>
                <div class="section-number">250</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%">No. | الرقم</th>
                        <th width="30%">Main Axis | المحور الرئيسي</th>
                        <th width="8%">Max Score | الدرجة القصوى</th>
                        <th width="12%">Achieved Score | الدرجة المحققة</th>
                        <th width="10%">Not Available | غير متوفر</th>
                        <th width="35%">Notes | الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="quality-criteria">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Evaluation Results -->
        <div class="results-summary">
            <h2 class="results-title">Evaluation Results Summary | ملخص نتائج التقييم</h2>
            <p style="text-align: center; color: #666; margin-bottom: 10px; font-size: 14px;">(Total depends on available items only) | (المجموع الكلي يعتمد على العناصر المتاحة فقط)</p>
            
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Axis | المحور</th>
                        <th>Max Score | الدرجة القصوى</th>
                        <th>Achieved Score | الدرجة المحققة</th>
                        <th>Percentage % | النسبة %</th>
                        <th>Circle | الدائرة</th>
                    </tr>
                </thead>
                <tbody id="results-body">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <div style="margin-top: 25px; text-align: center;">
                <h3 id="final-evaluation" style="padding: 15px; border-radius: 5px; background-color: #f8f9fa; font-size: 18px;">
                    Total Points: | إجمالي الدرجات: <span id="total-score-result">0</span> of | من <span id="total-max-result">1250</span> points | درجة
                </h3>
                <div style="margin-top: 15px; font-size: 17px;">
                    <strong>Final Evaluation: | التقييم النهائي:</strong> <span id="evaluation-text">Not evaluated yet | لم يتم التقييم بعد</span>
                </div>
                <div id="final-circle" class="final-evaluation-circle" style="margin-top: 15px;">
                    -
                </div>
            </div>
        </div>

        <!-- Control Buttons -->
        <div class="control-buttons">
            <button class="btn btn-primary" onclick="calculateResults()">Calculate Results | حساب النتائج</button>
            <button class="btn btn-success" onclick="saveAsPDF()">Save as PDF | حفظ كملف PDF</button>
            <button class="btn btn-warning" onclick="printEvaluation()">Print Report | طباعة التقرير</button>
            <button class="btn btn-primary" onclick="resetForm()">Reset | إعادة تعيين</button>
        </div>
    </div>

    <!-- Developer Signature -->
    <div class="signature-card">
        <div class="name">Yasser Elkhateeb</div>
        <div class="title">مطور البرنامج 67011143</div>
    </div>

    <!-- Hidden PDF Template -->
    <div id="pdf-template" style="position: absolute; left: -10000px; top: -10000px; width: 794px; height: 1123px; background: white; padding: 20px; box-sizing: border-box; font-family: 'Times New Roman', serif; font-size: 12px; direction: rtl;">
        <div style="text-align: center; margin-bottom: 15px;">
            <img src="https://i.postimg.cc/ry4Bxx0L/Bent_Aldeek_Logo.jpg" alt="Company Logo | شعار الشركة" style="width: 70px; height: 70px; border-radius: 50%; border: 2px solid #FFA500; margin-bottom: 10px;">
            <h2 style="color: #FFA500; margin: 0; font-size: 24px; font-weight: bold;">Bent Al-Deek Restaurants | مطاعم بنت الديك</h2>
            <h3 style="color: #FFA500; margin: 10px 0 15px 0; font-size: 20px; font-weight: bold;">Restaurant Evaluation Form | نموذج تقييم المطعم</h3>
            <div style="margin-bottom: 10px; font-size: 16px; font-weight: bold;">
                <div>Restaurant: | المطعم: <span id="pdf-restaurant" style="font-weight: bold;"></span></div>
                <div>Evaluation Date: | تاريخ التقييم: <span id="pdf-date"></span></div>
                <div>Evaluator: | القائم بالتقييم: <span id="pdf-evaluator"></span></div>
                <div>Area Manager: | مدير المنطقة: <span id="pdf-area-manager"></span> | Operation Manager: | مدير التشغيل: <span id="pdf-operation-manager"></span></div>
            </div>
        </div>
        
        <!-- Excellence Core Elements Diagram in PDF -->
        <div style="margin: 15px 0; text-align: center; border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
            <h4 style="color: #FFA500; margin: 0 0 10px 0; font-size: 16px; font-weight: bold;">Excellence Core Elements | العناصر الأساسية للتميز</h4>
            <div id="pdf-diagram" style="position: relative; width: 100%; height: 200px; margin: 0 auto;">
                <!-- Will be added here -->
            </div>
        </div>
        
        <div style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 4px; font-size: 13px;">
            <h4 style="color: #FFA500; margin: 0 0 8px 0; text-align: center; font-size: 16px;">Results Summary | ملخص النتائج</h4>
            <div id="pdf-summary" style="text-align: center;"></div>
        </div>
        
        <table style="font-size: 10px; border-collapse: collapse; width: 100%; margin-bottom: 15px;">
            <thead>
                <tr>
                    <th style="padding: 8px; border: 1px solid #000; text-align: center; background: #FFA500; color: white;">Axis | المحور</th>
                    <th style="padding: 8px; border: 1px solid #000; text-align: center; background: #FFA500; color: white;">Max Score | الدرجة القصوى</th>
                    <th style="padding: 8px; border: 1px solid #000; text-align: center; background: #FFA500; color: white;">Achieved Score | الدرجة المحققة</th>
                    <th style="padding: 8px; border: 1px solid #000; text-align: center; background: #FFA500; color: white;">Percentage % | النسبة %</th>
                </tr>
            </thead>
            <tbody id="pdf-results-body">
            </tbody>
        </table>
        
        <div style="margin-top: 15px; padding: 10px; border-top: 2px solid #FFA500; font-size: 13px;">
            <h4 style="color: #FFA500; margin: 0 0 8px 0; text-align: center; font-size: 16px;">Final Evaluation | التقييم النهائي</h4>
            <div id="pdf-final-evaluation" style="text-align: center; font-size: 15px; font-weight: bold;"></div>
            <!-- Add colored circle for final evaluation in PDF -->
            <div id="pdf-final-circle" style="width: 60px; height: 60px; border-radius: 50%; margin: 10px auto; display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 18px; color: white;">
                -
            </div>
        </div>
    </div>

    <script>
        // Restaurants Data - Bent Al-Deek Restaurants
        const restaurantsData = [
            { name: "الجهراء / Al Jahra", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "السالمية / Al Salmiya", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "الدسمة / Al Dasma", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "صباح السالم / sabah Elsalim", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "الفحاحيل / Al Fahahail", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "العارضية / Al Ardiya", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "هدية / Hadiya", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "صباح الأحمد / Sabah Elahmad", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "الصليبية / Al Sulaibya", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "خيطان / Khaitan", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" },
            { name: "الخيول / Al Khyoul", areaManager: "محمد مرتضى | Mohammed Murtada", operationManager: "محمد مرتضى | Mohammed Murtada" }
        ];

        // Evaluation Form Data
        const evaluationData = {
            service: [
                { id: "1.1", name: "Uniform | الزي الموحد", maxScore: 15 },
                { id: "1.2", name: "Customer Greeting | الترحيب بالعملاء", maxScore: 25 },
                { id: "1.3", name: "Suggestions | الاقتراحات", maxScore: 20 },
                { id: "1.4", name: "Thanking Customer | شكر العميل", maxScore: 20 },
                { id: "1.5", name: "Service Time | وقت الخدمة", maxScore: 35 },
                { id: "1.6", name: "Speaking Manner | طريقة الحديث", maxScore: 25 },
                { id: "1.7", name: "Cash Availability | توفر النقدية", maxScore: 15 },
                { id: "1.8", name: "Table Preparation | تجهيز الطاولات", maxScore: 20 },
                { id: "1.9", name: "Order Repetition | تكرار الطلب", maxScore: 15 },
                { id: "1.10", name: "Invoice Issuance | إصدار الفاتورة", maxScore: 10 }
            ],
            cleanliness: [
                { id: "2.1", name: "External Signs | اللافتات الخارجية", maxScore: 25 },
                { id: "2.2", name: "Doors and Windows | الأبواب والنوافذ", maxScore: 30 },
                { id: "2.3", name: "Trash Containers | حاويات القمامة", maxScore: 35 },
                { id: "2.4", name: "Hall/Floor/Walls | الصالة/الأرضية/الجدران", maxScore: 40 },
                { id: "2.5", name: "Tables, Chairs & Decor | الطاولات والكراسي والديكور", maxScore: 35 },
                { id: "2.6", name: "Trash/Pesticides | القمامة/مبيد الحشرات", maxScore: 30 },
                { id: "2.7", name: "Bathrooms | الحمامات", maxScore: 40 },
                { id: "2.8", name: "Price List/Counter | قائمة الأسعار/الكاونتر", maxScore: 20 },
                { id: "2.9", name: "Refrigerators & Coolers | الثلاجات والبرادات", maxScore: 25 },
                { id: "2.10", name: "Kitchen/Sinks | المطبخ/المغاسل", maxScore: 20 }
            ],
            equipment: [
                { id: "3.1", name: "Shawarma/Grill | الشاورما/الشواية", maxScore: 30 },
                { id: "3.2", name: "Storage Room | المخزن", maxScore: 25 },
                { id: "3.3", name: "Grill | الشواية", maxScore: 35 },
                { id: "3.4", name: "Drinks Refrigerator/Pepsi Machine | ثلاجة المشروبات/ماكينة بيبسي", maxScore: 30 },
                { id: "3.5", name: "Microwave | الميكروويف", maxScore: 20 },
                { id: "3.6", name: "Hoods/Filters | الشفاطات/الفلاتر", maxScore: 35 },
                { id: "3.7", name: "Delivery Cars | سيارات التوصيل", maxScore: 25 },
                { id: "3.8", name: "Toast Bread & rice | خبز التوست و الأرز", maxScore: 20 },
                { id: "3.9", name: "Preparation & Cutting Table | طاولة التحضير والتقطيع", maxScore: 20 },
                { id: "3.10", name: "The display is working well | الديسبليه يعمل جيداً", maxScore: 10 }
            ],
            management: [
                { id: "4.1", name: "Accountant/Cashier | المحاسب/الكاشير", maxScore: 30 },
                { id: "4.2", name: "Water Filters | فلاتر المياه", maxScore: 35 },
                { id: "4.3", name: "Manhole | المنهول", maxScore: 15 },
                { id: "4.4", name: "Air Conditioner | المكيف", maxScore: 40 },
                { id: "4.5", name: "Display Screen | شاشة العرض", maxScore: 20 },
                { id: "4.6", name: "Restaurant License | رخصة المطعم", maxScore: 30 },
                { id: "4.7", name: "Health Cards | كروت الصحة", maxScore: 30 },
                { id: "4.8", name: "Restaurant Report | تقرير المطعم", maxScore: 20 },
                { id: "4.9", name: "Staff Attendance | حضور الموظفين", maxScore: 20 },
                { id: "4.10", name: "Refrigerator Temperature | درجة حرارة الثلاجة", maxScore: 10 }
            ],
            quality: [
                { id: "5.1", name: "Bread Quality | جودة الخبز", maxScore: 25 },
                { id: "5.2", name: "Chicken Quality | جودة الدجاج", maxScore: 30 },
                { id: "5.3", name: "Vegetables Quality | جودة الخضروات", maxScore: 25 },
                { id: "5.4", name: "Salads Quality/Quantity | جودة/كمية السلطات", maxScore: 20 },
                { id: "5.5", name: "Food Quantity | كمية الطعام", maxScore: 25 },
                { id: "5.6", name: "The use of rolling and packaging | استخدام اللف والحزم", maxScore: 15 },
                { id: "5.7", name: "Cooking Timing | توقيت الطهي", maxScore: 20 },
                { id: "5.8", name: "Mixing Quality | جودة الخلط", maxScore: 20 },
                { id: "5.9", name: "Restaurant Papers | أوراق المطعم", maxScore: 15 },
                { id: "5.10", name: "Wasted Meals | وجبات مهدرة", maxScore: 20 },
                { id: "5.11", name: "Entry & Exit | الدخول والخروج", maxScore: 15 }
            ]
        };

        // Initialize Form
        function initializeForm() {
            // Initialize dynamic restaurant search
            setupRestaurantSearch();
            
            // Fill evaluation criteria
            fillCriteriaTable('service-criteria', evaluationData.service);
            fillCriteriaTable('cleanliness-criteria', evaluationData.cleanliness);
            fillCriteriaTable('equipment-criteria', evaluationData.equipment);
            fillCriteriaTable('management-criteria', evaluationData.management);
            fillCriteriaTable('quality-criteria', evaluationData.quality);
            
            // Add event listeners for automatic results calculation
            document.querySelectorAll('.score-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    calculateResults();
                });
            });
            
            document.querySelectorAll('.not-available-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const itemId = this.getAttribute('data-id').replace('na-', 'score-');
                    const scoreBtn = document.querySelector(`button[data-id="${itemId}"]`);
                    const hiddenInput = document.getElementById(itemId);
                    
                    if (this.checked) {
                        // If "Not Available" is checked, set score to 0
                        scoreBtn.textContent = '0';
                        scoreBtn.classList.remove('active');
                        if (hiddenInput) hiddenInput.value = '0';
                    }
                    calculateResults();
                });
            });
            
            // Calculate initial results
            calculateResults();
        }

        // Setup dynamic restaurant search
        function setupRestaurantSearch() {
            const searchInput = document.getElementById('restaurant-search');
            const dropdown = document.getElementById('restaurant-dropdown');
            const selectedRestaurantInput = document.getElementById('selected-restaurant');
            
            // Fill dropdown list
            restaurantsData.forEach(restaurant => {
                const item = document.createElement('div');
                item.className = 'restaurant-dropdown-item';
                item.textContent = restaurant.name;
                item.addEventListener('click', function() {
                    searchInput.value = restaurant.name;
                    selectedRestaurantInput.value = restaurant.name;
                    updateRestaurantDetails();
                    dropdown.style.display = 'none';
                });
                dropdown.appendChild(item);
            });
            
            // Dynamic search
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const items = dropdown.querySelectorAll('.restaurant-dropdown-item');
                let hasMatches = false;
                
                items.forEach(item => {
                    if (item.textContent.toLowerCase().includes(searchTerm)) {
                        item.style.display = 'block';
                        hasMatches = true;
                    } else {
                        item.style.display = 'none';
                    }
                });
                
                if (searchTerm && hasMatches) {
                    dropdown.style.display = 'block';
                } else {
                    dropdown.style.display = 'none';
                }
                
                // If text exactly matches a restaurant
                const exactMatch = restaurantsData.find(r => r.name.toLowerCase() === searchTerm);
                if (exactMatch) {
                    selectedRestaurantInput.value = exactMatch.name;
                    updateRestaurantDetails();
                } else if (!searchTerm) {
                    selectedRestaurantInput.value = '';
                    updateRestaurantDetails();
                }
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.style.display = 'none';
                }
            });
        }

        // Update restaurant details
        function updateRestaurantDetails() {
            const selectedRestaurant = document.getElementById('selected-restaurant').value;
            
            if (selectedRestaurant) {
                const restaurant = restaurantsData.find(r => r.name === selectedRestaurant);
                if (restaurant) {
                    document.getElementById('area-manager').textContent = restaurant.areaManager;
                    document.getElementById('operation-manager').textContent = restaurant.operationManager;
                }
            } else {
                document.getElementById('area-manager').textContent = '-';
                document.getElementById('operation-manager').textContent = '-';
            }
        }

        // Fill criteria table
        function fillCriteriaTable(tableId, criteria) {
            const tableBody = document.getElementById(tableId);
            tableBody.innerHTML = '';
            
            criteria.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="criteria-number">${item.id}</td>
                    <td class="criteria-name">${item.name}</td>
                    <td class="max-score">${item.maxScore}</td>
                    <td class="achieved-score">
                        <button type="button" class="score-btn" data-id="score-${item.id}" data-max="${item.maxScore}">0</button>
                        <input type="hidden" id="score-${item.id}" value="0">
                    </td>
                    <td class="not-available">
                        <input type="checkbox" class="not-available-checkbox" data-id="na-${item.id}">
                    </td>
                    <td class="notes">
                        <input type="text" id="notes-${item.id}" placeholder="Add your notes here | أضف ملاحظاتك هنا">
                    </td>
                `;
                tableBody.appendChild(row);
                
                // Add click event to score button
                const scoreBtn = row.querySelector('.score-btn');
                scoreBtn.addEventListener('click', function() {
                    const notAvailableCheckbox = row.querySelector('.not-available-checkbox');
                    
                    // If item is not available, cannot change score
                    if (notAvailableCheckbox && notAvailableCheckbox.checked) {
                        alert('Cannot modify score for unavailable item. Please uncheck "Not Available" first. | لا يمكن تعديل درجة عنصر غير متوفر. يرجى إلغاء تحديد "غير متوفر" أولاً.');
                        return;
                    }
                    
                    const currentScore = parseInt(this.textContent) || 0;
                    const maxScore = parseInt(this.getAttribute('data-max'));
                    const newScore = currentScore === maxScore ? 0 : maxScore;
                    this.textContent = newScore;
                    this.classList.toggle('active', newScore === maxScore);
                    
                    // Update hidden field
                    const hiddenInput = document.getElementById(this.getAttribute('data-id'));
                    if (hiddenInput) {
                        hiddenInput.value = newScore;
                    }
                    
                    calculateResults();
                });
            });
        }

        // Calculate Results
        function calculateResults() {
            let totalAchieved = 0;
            let totalMax = 0;
            const results = [];
            
            // Calculate for each axis
            const categories = [
                { id: 'service', name: 'Customer Service | خدمة العملاء', maxTotal: 200 },
                { id: 'cleanliness', name: 'Cleanliness | النظافة', maxTotal: 300 },
                { id: 'equipment', name: 'Equipment | المعدات والتجهيزات', maxTotal: 250 },
                { id: 'management', name: 'Management | إدارة المطعم', maxTotal: 250 },
                { id: 'quality', name: 'Quality | الجودة', maxTotal: 250 }
            ];
            
            categories.forEach(category => {
                let achieved = 0;
                let availableMax = 0; // For available items only
                
                evaluationData[category.id].forEach(item => {
                    const notAvailableCheckbox = document.querySelector(`input[data-id="na-${item.id}"]`);
                    const isNotAvailable = notAvailableCheckbox && notAvailableCheckbox.checked;
                    
                    if (!isNotAvailable) {
                        availableMax += item.maxScore;
                        
                        const scoreInput = document.getElementById(`score-${item.id}`);
                        const score = parseInt(scoreInput.value) || 0;
                        
                        // Ensure achieved score doesn't exceed max score
                        if (score > item.maxScore) {
                            scoreInput.value = item.maxScore;
                            achieved += item.maxScore;
                        } else {
                            achieved += score;
                        }
                    }
                });
                
                // If there are unavailable items, adjust max score
                const adjustedMax = availableMax > 0 ? availableMax : 0;
                
                totalAchieved += achieved;
                totalMax += adjustedMax;
                
                const percentage = adjustedMax > 0 ? Math.round((achieved / adjustedMax) * 100) : 0;
                results.push({
                    id: category.id,
                    name: category.name,
                    maxScore: adjustedMax,
                    achievedScore: achieved,
                    percentage: percentage,
                    originalMax: category.maxTotal
                });
                
                // Update boxes in diagram (only for first four axes)
                if (category.id !== 'quality') {
                    updateDiagramBox(category.id, achieved, adjustedMax);
                }
            });
            
            // Calculate total percentage
            const totalPercentage = totalMax > 0 ? Math.round((totalAchieved / totalMax) * 100) : 0;
            
            // Update statistics cards
            updateStatsCards(totalAchieved, totalPercentage, totalMax);
            
            // Update results table
            updateResultsTable(results, totalAchieved, totalPercentage, totalMax);
            
            // Update final evaluation
            updateFinalEvaluation(totalPercentage, totalAchieved, totalMax);
        }

        // Update boxes in diagram
        function updateDiagramBox(categoryId, achieved, max) {
            const boxElement = document.getElementById(`${categoryId}-box`);
            if (boxElement) {
                const scoreElement = boxElement.querySelector('.axis-score');
                const totalElement = boxElement.querySelector('.axis-total');
                
                if (scoreElement) scoreElement.textContent = achieved;
                if (totalElement) totalElement.textContent = `of ${max} | من ${max}`;
                
                // Update box color based on percentage
                const percentage = max > 0 ? Math.round((achieved / max) * 100) : 0;
                boxElement.style.borderColor = getPercentageColorForDiagram(percentage);
            }
        }

        // Update statistics cards
        function updateStatsCards(totalAchieved, totalPercentage, totalMax) {
            document.getElementById('total-score').textContent = totalAchieved;
            document.getElementById('total-percentage').textContent = totalPercentage + '%';
            
            // Calculate quality score (remaining)
            const qualityScore = totalMax - totalAchieved;
            document.getElementById('quality-score').textContent = qualityScore;
            
            // Update card colors based on percentage
            const statCards = document.querySelectorAll('.stat-card');
            statCards.forEach(card => {
                card.classList.remove('yellow', 'orange', 'green', 'gold');
                
                if (totalPercentage < 75) {
                    card.classList.add('yellow');
                    document.getElementById('final-grade').textContent = '🔴 Intervention | تدخل';
                } else if (totalPercentage >= 75 && totalPercentage < 85) {
                    card.classList.add('orange');
                    document.getElementById('final-grade').textContent = '🟡 Follow-up | متابعة';
                } else if (totalPercentage >= 85 && totalPercentage < 90) {
                    card.classList.add('green');
                    document.getElementById('final-grade').textContent = '🟢 Good | جيد';
                } else if (totalPercentage >= 90) {
                    card.classList.add('gold');
                    document.getElementById('final-grade').textContent = '🟡✨ Excellent | ممتاز';
                }
            });
        }

        // Update results table
        function updateResultsTable(results, totalAchieved, totalPercentage, totalMax) {
            const resultsBody = document.getElementById('results-body');
            resultsBody.innerHTML = '';
            
            // Add result rows for each axis
            results.forEach(result => {
                const row = document.createElement('tr');
                const colorClass = getPercentageColorClass(result.percentage);
                const circleColor = getPercentageColorForCircle(result.percentage);
                
                row.innerHTML = `
                    <td>${result.name}</td>
                    <td>${result.maxScore}</td>
                    <td>${result.achievedScore}</td>
                    <td class="percentage-cell" style="background-color: ${getPercentageColor(result.percentage)};">${result.percentage}%</td>
                    <td>
                        <div class="final-evaluation-circle" style="background-color: ${circleColor}; width: 40px; height: 40px; font-size: 14px;">
                            ${result.percentage}%
                        </div>
                    </td>
                `;
                resultsBody.appendChild(row);
            });
            
            // Add total row
            const totalRow = document.createElement('tr');
            totalRow.classList.add('total-row');
            const totalColor = getPercentageColor(totalPercentage);
            const totalCircleColor = getPercentageColorForCircle(totalPercentage);
            
            totalRow.innerHTML = `
                <td><strong>Total (1-5) | الإجمالي (1-5)</strong></td>
                <td><strong>${totalMax}</strong></td>
                <td><strong>${totalAchieved}</strong></td>
                <td class="percentage-cell" style="background-color: ${totalColor};"><strong>${totalPercentage}%</strong></td>
                <td>
                    <div class="final-evaluation-circle" style="background-color: ${totalCircleColor}; width: 50px; height: 50px; font-size: 16px;">
                        ${totalPercentage}%
                    </div>
                </td>
            `;
            resultsBody.appendChild(totalRow);
            
            // Update total result
            document.getElementById('total-score-result').textContent = totalAchieved;
            document.getElementById('total-max-result').textContent = totalMax;
        }

        // Update final evaluation
        function updateFinalEvaluation(percentage, totalAchieved, totalMax) {
            const evaluationText = document.getElementById('evaluation-text');
            const finalEvaluation = document.getElementById('final-evaluation');
            const finalCircle = document.getElementById('final-circle');
            
            let color, text, circleColor;
            
            if (percentage < 75) {
                text = 'Red - Needs Immediate Intervention | أحمر - يحتاج تدخل فوري';
                color = '#e74c3c';
                circleColor = '#e74c3c';
                finalEvaluation.style.backgroundColor = '#ffeaea';
                finalEvaluation.style.color = '#e74c3c';
            } else if (percentage >= 75 && percentage < 85) {
                text = 'Yellow - Needs Follow-up | أصفر - يحتاج متابعة';
                color = '#f39c12';
                circleColor = '#f39c12';
                finalEvaluation.style.backgroundColor = '#fff9e6';
                finalEvaluation.style.color = '#f39c12';
            } else if (percentage >= 85 && percentage < 90) {
                text = 'Green - Good Performance | أخضر - أداء جيد';
                color = '#27ae60';
                circleColor = '#27ae60';
                finalEvaluation.style.backgroundColor = '#e8f7ef';
                finalEvaluation.style.color = '#27ae60';
            } else if (percentage >= 90) {
                text = 'Gold - Excellent Performance | ذهبي - أداء ممتاز';
                color = '#b8860b';
                circleColor = '#ffd700';
                finalEvaluation.style.backgroundColor = '#fffce6';
                finalEvaluation.style.color = '#b8860b';
            }
            
            evaluationText.textContent = text;
            evaluationText.style.color = color;
            
            // Update circle
            if (finalCircle) {
                finalCircle.style.backgroundColor = circleColor;
                finalCircle.textContent = percentage + '%';
                finalCircle.style.color = 'white';
            }
        }

        // Get percentage color
        function getPercentageColor(percentage) {
            if (percentage < 75) return '#ffeaea';
            if (percentage >= 75 && percentage < 85) return '#fff9e6';
            if (percentage >= 85 && percentage < 90) return '#e8f7ef';
            return '#fffce6';
        }

        // Get percentage color for diagram
        function getPercentageColorForDiagram(percentage) {
            if (percentage < 75) return '#e74c3c';
            if (percentage >= 75 && percentage < 85) return '#f39c12';
            if (percentage >= 85 && percentage < 90) return '#27ae60';
            return '#ffd700';
        }

        // Get circle color for percentage
        function getPercentageColorForCircle(percentage) {
            if (percentage < 75) return '#e74c3c';
            if (percentage >= 75 && percentage < 85) return '#f39c12';
            if (percentage >= 85 && percentage < 90) return '#27ae60';
            return '#ffd700';
        }

        // Get percentage color class
        function getPercentageColorClass(percentage) {
            if (percentage < 75) return 'yellow';
            if (percentage >= 75 && percentage < 85) return 'orange';
            if (percentage >= 85 && percentage < 90) return 'green';
            return 'gold';
        }

        // Save report as PDF file
        async function saveAsPDF() {
            if (!window.jspdf) {
                alert('PDF library not loaded. Please check internet connection. | مكتبة PDF غير محملة. يرجى التحقق من الاتصال بالإنترنت.');
                return;
            }
            
            try {
                // Calculate results first
                calculateResults();
                
                // Prepare PDF data
                const today = new Date();
                const formattedDate = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
                document.getElementById('pdf-date').textContent = formattedDate;
                
                // Add restaurant name and information
                const selectedRestaurant = document.getElementById('selected-restaurant').value;
                document.getElementById('pdf-restaurant').textContent = selectedRestaurant || 'Not Specified | غير محدد';
                
                const restaurant = restaurantsData.find(r => r.name === selectedRestaurant);
                if (restaurant) {
                    document.getElementById('pdf-area-manager').textContent = restaurant.areaManager;
                    document.getElementById('pdf-operation-manager').textContent = restaurant.operationManager;
                } else {
                    document.getElementById('pdf-area-manager').textContent = '-';
                    document.getElementById('pdf-operation-manager').textContent = '-';
                }
                
                document.getElementById('pdf-evaluator').textContent = document.getElementById('evaluator-name').value || 'Not Specified | غير محدد';
                
                // Calculate total results
                const totalAchieved = parseInt(document.getElementById('total-score').textContent);
                const totalPercentage = parseInt(document.getElementById('total-percentage').textContent);
                const totalMax = parseInt(document.getElementById('total-max-result').textContent);
                const evaluationText = document.getElementById('evaluation-text').textContent;
                
                document.getElementById('pdf-summary').innerHTML = `
                    <div>Total Points: | إجمالي الدرجات: <strong>${totalAchieved}</strong> of | من <strong>${totalMax}</strong> points | درجة</div>
                    <div>Percentage: | النسبة المئوية: <strong>${totalPercentage}%</strong></div>
                `;
                
                // Setup simplified PDF diagram
                const pdfDiagram = document.getElementById('pdf-diagram');
                pdfDiagram.innerHTML = `
                    <div style="position: relative; width: 300px; height: 150px; margin: 0 auto;">
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80px; height: 80px; background: linear-gradient(135deg, #FFD700, #FFA500); border-radius: 50%; display: flex; justify-content: center; align-items: center; color: white; font-weight: bold; font-size: 12px; text-align: center; border: 3px solid white; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                            Goal: | الهدف:<br>Quality | الجودة
                        </div>
                        <div style="position: absolute; top: 20px; right: 20px; width: 70px; height: 50px; background: white; border-radius: 5px; border: 2px solid #FFD700; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 10px; padding: 5px;">
                            <div style="font-weight: bold;">Customer Service | خدمة العملاء</div>
                            <div style="font-size: 12px; font-weight: bold;">${document.querySelector('#service-box .axis-score').textContent}</div>
                            <div>of | من ${document.querySelector('#service-box .axis-total').textContent.replace('of ', '').replace('من ', '')}</div>
                        </div>
                        <div style="position: absolute; top: 20px; left: 20px; width: 70px; height: 50px; background: white; border-radius: 5px; border: 2px solid #FFA500; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 10px; padding: 5px;">
                            <div style="font-weight: bold;">Cleanliness | النظافة</div>
                            <div style="font-size: 12px; font-weight: bold;">${document.querySelector('#cleanliness-box .axis-score').textContent}</div>
                            <div>of | من ${document.querySelector('#cleanliness-box .axis-total').textContent.replace('of ', '').replace('من ', '')}</div>
                        </div>
                        <div style="position: absolute; bottom: 20px; right: 20px; width: 70px; height: 50px; background: white; border-radius: 5px; border: 2px solid #E6B800; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 10px; padding: 5px;">
                            <div style="font-weight: bold;">Equipment | التجهيزات</div>
                            <div style="font-size: 12px; font-weight: bold;">${document.querySelector('#equipment-box .axis-score').textContent}</div>
                            <div>of | من ${document.querySelector('#equipment-box .axis-total').textContent.replace('of ', '').replace('من ', '')}</div>
                        </div>
                        <div style="position: absolute; bottom: 20px; left: 20px; width: 70px; height: 50px; background: white; border-radius: 5px; border: 2px solid #FF8C00; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 10px; padding: 5px;">
                            <div style="font-weight: bold;">Management | الإدارة</div>
                            <div style="font-size: 12px; font-weight: bold;">${document.querySelector('#management-box .axis-score').textContent}</div>
                            <div>of | من ${document.querySelector('#management-box .axis-total').textContent.replace('of ', '').replace('من ', '')}</div>
                        </div>
                    </div>
                `;
                
                // Setup results table in PDF
                const pdfResultsBody = document.getElementById('pdf-results-body');
                pdfResultsBody.innerHTML = '';
                
                const categories = ['Customer Service | خدمة العملاء', 'Cleanliness | النظافة', 'Equipment | المعدات والتجهيزات', 'Management | إدارة المطعم', 'Quality | الجودة'];
                
                // Calculate achieved scores for each axis
                let totalAchievedForPDF = 0;
                let totalMaxForPDF = 0;
                
                categories.forEach((category, index) => {
                    let achieved = 0;
                    let availableMax = 0;
                    const categoryData = evaluationData[Object.keys(evaluationData)[index]];
                    
                    categoryData.forEach(item => {
                        const notAvailableCheckbox = document.querySelector(`input[data-id="na-${item.id}"]`);
                        const isNotAvailable = notAvailableCheckbox && notAvailableCheckbox.checked;
                        
                        if (!isNotAvailable) {
                            availableMax += item.maxScore;
                            const scoreInput = document.getElementById(`score-${item.id}`);
                            achieved += parseInt(scoreInput.value) || 0;
                        }
                    });
                    
                    totalAchievedForPDF += achieved;
                    totalMaxForPDF += availableMax;
                    const percentage = availableMax > 0 ? Math.round((achieved / availableMax) * 100) : 0;
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td style="padding: 6px; border: 1px solid #000; text-align: center;">${category}</td>
                        <td style="padding: 6px; border: 1px solid #000; text-align: center;">${availableMax}</td>
                        <td style="padding: 6px; border: 1px solid #000; text-align: center;">${achieved}</td>
                        <td style="padding: 6px; border: 1px solid #000; text-align: center; background-color: ${getPercentageColor(percentage)}; color: black;">${percentage}%</td>
                    `;
                    pdfResultsBody.appendChild(row);
                });
                
                // Add total row
                const totalRow = document.createElement('tr');
                totalRow.innerHTML = `
                    <td style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: bold;">Total | الإجمالي</td>
                    <td style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: bold;">${totalMaxForPDF}</td>
                    <td style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: bold;">${totalAchievedForPDF}</td>
                    <td style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: bold; background-color: ${getPercentageColor(totalPercentage)}; color: black;">${totalPercentage}%</td>
                `;
                pdfResultsBody.appendChild(totalRow);
                
                // Add final evaluation with colored circle
                const finalCircleColor = getPercentageColorForCircle(totalPercentage);
                document.getElementById('pdf-final-evaluation').innerHTML = `
                    <div>${evaluationText}</div>
                `;
                
                // Update colored circle in PDF
                const pdfFinalCircle = document.getElementById('pdf-final-circle');
                pdfFinalCircle.style.backgroundColor = finalCircleColor;
                pdfFinalCircle.textContent = totalPercentage + '%';
                pdfFinalCircle.style.color = 'white';
                
                // Prepare element for capture
                const element = document.getElementById('pdf-template');
                const originalStyles = {
                    display: element.style.display,
                    position: element.style.position,
                    left: element.style.left,
                    top: element.style.top,
                    width: element.style.width,
                    height: element.style.height,
                    zIndex: element.style.zIndex
                };
                
                element.style.display = 'block';
                element.style.position = 'fixed';
                element.style.left = '0';
                element.style.top = '0';
                element.style.width = '794px';
                element.style.height = '1123px';
                element.style.zIndex = '10000';
                element.style.background = 'white';
                element.style.padding = '20px';
                
                // Use html2canvas to capture image
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#FFFFFF',
                    width: 794,
                    height: 1123,
                    windowWidth: 794,
                    windowHeight: 1123
                });
                
                // Restore element to original state
                element.style.display = originalStyles.display;
                element.style.position = originalStyles.position;
                element.style.left = originalStyles.left;
                element.style.top = originalStyles.top;
                element.style.width = originalStyles.width;
                element.style.height = originalStyles.height;
                element.style.zIndex = originalStyles.zIndex;
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const pdf = new window.jspdf.jsPDF('p', 'pt', 'a4');
                
                const imgWidth = pdf.internal.pageSize.getWidth();
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                // Add image to PDF
                pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                
                // Save PDF file
                const restaurantName = selectedRestaurant ? selectedRestaurant.replace(/\s+/g, '_') : 'evaluation';
                const fileName = `Evaluation_${restaurantName}_${formattedDate}.pdf`;
                pdf.save(fileName);
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                alert('Error occurred while generating PDF file: | حدث خطأ أثناء إنشاء ملف PDF: ' + error.message);
            }
        }

        // Print report
        function printEvaluation() {
            calculateResults();
            window.print();
        }

        // Reset form
        function resetForm() {
            if (confirm('Are you sure you want to reset all data? | هل أنت متأكد من إعادة تعيين جميع البيانات؟')) {
                document.querySelectorAll('.score-btn').forEach(btn => {
                    btn.textContent = '0';
                    btn.classList.remove('active');
                });
                
                document.querySelectorAll('input[type="hidden"]').forEach(input => {
                    input.value = '0';
                });
                
                document.querySelectorAll('.not-available-checkbox').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                document.querySelectorAll('input[type="text"]').forEach(input => {
                    input.value = '';
                });
                
                document.getElementById('evaluator-name').value = '';
                document.getElementById('restaurant-search').value = '';
                document.getElementById('selected-restaurant').value = '';
                document.getElementById('area-manager').textContent = '-';
                document.getElementById('operation-manager').textContent = '-';
                
                calculateResults();
            }
        }

        // Initialize form when page loads
        document.addEventListener('DOMContentLoaded', initializeForm);
    </script>
</body>
</html>
